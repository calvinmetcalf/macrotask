{"version":3,"file":null,"sources":["../node_modules/rollup-plugin-node-globals/src/global.js","../node_modules/rollup-plugin-node-globals/src/browser.js","../lib/async/deadline.js","../lib/async/setImmediate.js","../lib/async/postMessage.js","../lib/async/messageChannel.js","../lib/async/stateChange.js","../lib/async/timeout.js","../lib/async/idleCallback.js","../lib/nextTick.js","../lib/item.js","../lib/list.js","../lib/index.js"],"sourcesContent":["export default typeof global !== \"undefined\" ? global :\n            typeof self !== \"undefined\" ? self :\n            typeof window !== \"undefined\" ? window : {}\n","export var browser = true;\n","let perf;\n\nexport class Deadline {\n  constructor(limit = 10) {\n    this.limit = limit;\n    this.performance = Deadline.getPerformance();\n    this.now = this.getTime();\n  }\n  getTime() {\n    return this.performance ? global.performance.now() : Date.now();\n  }\n  timeRemaining() {\n    const out = this.limit  - (this.getTime() - this.now);\n    if (out > 0) {\n      return out;\n    }\n    return 0;\n  }\n  static getPerformance() {\n    if (perf === undefined) {\n      perf = !!(global.performance && global.performance.now && typeof global.performance.now === 'function')\n    }\n    return perf;\n  }\n\n}\n","import {Deadline} from './deadline';\n\nexport const test = () => !process.browser && global && typeof global.setImmediate === 'function';\n\nexport const install = func => () => global.setImmediate(()=>func(new Deadline()));\n","// The test against `importScripts` prevents this implementation from being installed inside a web worker,\n// where `global.postMessage` means something completely different and can't be used for this purpose.\nimport {Deadline} from './deadline';\n\nexport function test() {\n  if (!global.postMessage || global.importScripts) {\n    return false;\n  }\n  if (global.setImmediate) {\n    // we can only get here in IE10\n    // which doesn't handel postMessage well\n    return false;\n  }\n  var postMessageIsAsynchronous = true;\n  var oldOnMessage = global.onmessage;\n  global.onmessage = function () {\n    postMessageIsAsynchronous = false;\n  };\n  global.postMessage('', '*');\n  global.onmessage = oldOnMessage;\n\n  return postMessageIsAsynchronous;\n};\n\nexport function install (func) {\n  var codeWord = 'macrotask' + Math.random();\n  function globalMessage(event) {\n    if (event.source === global && event.data === codeWord) {\n      func(new Deadline());\n    }\n  }\n  if (global.addEventListener) {\n    global.addEventListener('message', globalMessage, false);\n  } else {\n    global.attachEvent('onmessage', globalMessage);\n  }\n  return function () {\n    global.postMessage(codeWord, '*');\n  };\n};\n","import {Deadline} from './deadline';\nexport function test() {\n  if (global.setImmediate) {\n    // we can only get here in IE10\n    // which doesn't handel postMessage well\n    return false;\n  }\n  return typeof global.MessageChannel !== 'undefined';\n};\n\nexport function install(func) {\n  var channel = new global.MessageChannel();\n  channel.port1.onmessage = ()=>func(new Deadline());\n  return function () {\n    channel.port2.postMessage(0);\n  };\n};\n","import {Deadline} from './deadline';\n\nexport const test = () =>\n  'document' in global && 'onreadystatechange' in global.document.createElement('script');\n\nexport const install = handle => function () {\n\n    // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n    // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n    var scriptEl = global.document.createElement('script');\n    scriptEl.onreadystatechange = function () {\n      handle(new Deadline());\n\n      scriptEl.onreadystatechange = null;\n      scriptEl.parentNode.removeChild(scriptEl);\n      scriptEl = null;\n    };\n    global.document.documentElement.appendChild(scriptEl);\n\n    return handle;\n  };\n","import {Deadline} from './deadline';\n\nexport const test =  () => true;\n\nexport function install(t) {\n  return function () {\n    setTimeout(()=>{\n      t(new Deadline())\n    }, 0);\n  };\n};\n","export const test = () => typeof global.requestIdleCallback === 'function';\nexport const install = func => () => global.requestIdleCallback(func);\n","import * as setImmediate from './async/setImmediate';\nimport * as postMessage from './async/postMessage';\nimport * as messageChannel from './async/messageChannel';\nimport * as stateChange from './async/stateChange';\nimport * as timeout from './async/timeout';\nimport * as idleCallback from './async/idleCallback';\nconst types = [\n  setImmediate,\n  idleCallback,\n  postMessage,\n  messageChannel,\n  stateChange,\n  timeout\n];\nexport default function (drainQueue) {\n  for (let type of types) {\n    if (type.test()) {\n      return type.install(drainQueue);\n    }\n  }\n}\n","class CancelToken{}\nfunction throwStuff(e) {\n  throw e;\n}\n// v8 likes predictible objects\nexport class Item {\n  constructor(fun, array, list) {\n    this.fun = fun;\n    this.array = array;\n    this.token = new CancelToken();\n    this.prev = null;\n    this.next = null;\n    this.list = list;\n  }\n  run() {\n    const fun = this.fun;\n    const array = this.array;\n    switch (array.length) {\n      case 0:\n        fun();\n        break;\n      case 1:\n        fun(array[0]);\n        break;\n      case 2:\n        fun(array[0], array[1]);\n        break;\n      case 3:\n        fun(array[0], array[1], array[2]);\n        break;\n      default:\n        fun(...array);\n        break;\n    }\n  }\n  cancel() {\n    const next = this.next;\n    const prev = this.prev;\n    if (next === null) {\n      if (prev === null) {\n        // only thing on list\n        if (this.list.head === this && this.list.length === 1) {\n          // sanity check\n          this.list.head = this.list.tail = null;\n        } else {\n          return;\n        }\n      } else {\n        prev.next = null;\n        this.list.tail = prev;\n        // tail of list\n      }\n    } else {\n      if (prev === null) {\n        // head of list\n        next.prev = null;\n        this.list.head = next;\n      } else {\n        // middle of list\n        prev.next = next;\n        next.prev = prev;\n      }\n    }\n    this.list.length--;\n  }\n}\n","import {Item} from './item';\n\nexport class List {\n  constructor() {\n    this.length = 0;\n    this.head = null;\n    this.tail = null;\n    this.cache = new WeakMap();\n  }\n  push(func, args) {\n    const item = new Item(func, args, this);\n    if (this.length > 0) {\n      const currentTail = this.tail;\n      currentTail.next = item;\n      item.prev = currentTail;\n      this.tail = item;\n    } else {\n      this.head = this.tail = item;\n    }\n    this.length++;\n    this.cache.set(item.token, item);\n    return item.token;\n  }\n  shift() {\n    if (this.length < 1) {\n      return;\n    }\n    const item = this.head;\n    if (this.length === 1) {\n        this.head = this.tail = null;\n    } else {\n      const newHead = item.next;\n      newHead.prev = null;\n      this.head = newHead;\n    }\n    this.length--;\n    this.cache.delete(item.token);\n    return item;\n  }\n  cancel(token) {\n    const item = this.cache.get(token);\n    if (item) {\n      this.cache.delete(token);\n    } else {\n      return false;\n    }\n    item.cancel();\n    return true;\n  }\n}\n","import creatNextTick from './nextTick';\nimport {List} from './list';\nconst list = new List();\nlet inProgress = false;\nlet nextTick;\n\nfunction drainQueue(idleDeadline) {\n  if (!list.length) {\n    inProgress = false;\n    return;\n  }\n  let task = list.shift();\n  if (!list.length) {\n    inProgress = false;\n  } else {\n    nextTick();\n  }\n  task.run();\n  if (!idleDeadline) {\n    return;\n  }\n  while (idleDeadline.timeRemaining() > 0 && list.length) {\n    let task = list.shift();\n    task.run();\n  }\n}\n\nexport function run (task, ...args) {\n  const token = list.push(task, args);\n  if (inProgress) {\n    return token;\n  }\n  if (!nextTick) {\n    nextTick = creatNextTick(drainQueue);\n  }\n  inProgress = true;\n  nextTick();\n  return token;\n};\nexport function clear (token) {\n  return list.cancel(token);\n};\n"],"names":["global","self","window","browser","perf","Deadline","limit","performance","getPerformance","now","getTime","Date","timeRemaining","out","undefined","test","process.browser","setImmediate","install","func","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","codeWord","Math","random","globalMessage","event","source","data","addEventListener","attachEvent","MessageChannel","channel","port1","port2","document","createElement","scriptEl","onreadystatechange","parentNode","removeChild","documentElement","appendChild","handle","t","requestIdleCallback","types","idleCallback","messageChannel","stateChange","timeout","drainQueue","type","CancelToken","Item","fun","array","list","token","prev","next","run","length","cancel","head","tail","List","cache","WeakMap","push","args","item","currentTail","set","shift","newHead","delete","get","inProgress","nextTick","idleDeadline","task","creatNextTick","clear"],"mappings":"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"}